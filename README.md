# Telegram buddy

Telegram бот-помощник для быстрых напоминаний с помощью голосовых сообщений и скачивания медиа без авторизации с instagram/tiktok

## Возможности

- Создание задач через голосовые сообщения
- Автоматическое распознавание текста и времени выполнения задачи
- Отправка напоминаний о задачах в указанное время
- Скачивание медиа по ссылке Instagram
- Скачивание медиа по ссылке TikTok


## Установка

1. Клонируйте репозиторий:
   ```
   git clone https://github.com/Catanix/telegram-buddy.git
   cd telegram-buddy
   ```

2. Установите зависимости:
   ```
   npm install
   ```

3. Создайте файл `.env` на основе `.env.example` и заполните его своими данными:
   ```
   cp .env.example .env
   ```

4. Отредактируйте файл `.env`, указав:
   - `TELEGRAM_TOKEN` - токен вашего Telegram бота (получите у [@BotFather](https://t.me/BotFather))
   - `AUTHORIZED_USERNAME` - ваш username в Telegram (без символа @)
   - `DEEPSEEK_API_KEY` - ключ API для сервиса DeepSeek

## Запуск

### Обычный запуск

```
node index.js
```

### Запуск с помощью Docker

1. Настройте переменные окружения одним из способов:

   **Способ 1**: Используйте скрипт настройки:
   ```
   npm run setup-env
   ```

   **Способ 2**: Вручную скопируйте `.env.example` в `.env` и отредактируйте его:
   ```
   cp .env.example .env
   ```

   **Способ 3**: Задайте переменные окружения напрямую в командной строке:
   ```
   export TELEGRAM_TOKEN=your_token
   export AUTHORIZED_USERNAME=your_username
   export DEEPSEEK_API_KEY=your_api_key
   ```

2. Запустите контейнер с помощью Docker Compose:
   ```
   docker compose up -d
   ```

   > **Примечание**: Docker Compose автоматически создаст файл `.env` внутри контейнера на основе переменных окружения, 
   > переданных из вашей системы. Вам не нужно копировать файл `.env` вручную.

3. Проверьте логи:
   ```
   docker compose logs -f
   ```

#### Управление контейнером

- Остановка контейнера:
  ```
  docker compose down
  ```

- Перезапуск контейнера:
  ```
  docker compose restart
  ```

- Обновление после изменения кода:
  ```
  docker compose up -d --build
  ```

#### Хранение данных

Docker Compose настроен для сохранения данных в следующих директориях:
- `./data/db`: База данных SQLite
- `./data/tmp`: Временные файлы для обработки голосовых сообщений

## Использование

1. Отправьте голосовое сообщение боту с описанием задачи и временем её выполнения
2. Бот распознает текст, извлечет задачу и время
3. Подтвердите создание задачи, нажав на кнопку "Подтвердить"
4. Бот отправит вам напоминание о задаче в указанное время

## Структура проекта

- `index.js` - точка входа в приложение
- `src/bot/` - код Telegram бота
- `src/models/` - модели данных
- `src/services/` - сервисы (база данных, API)
- `src/core/` - основные компоненты (планировщик)
- `src/utils/` - утилиты

## Технологии

- Node.js
- Telegraf (Telegram Bot API)
- SQLite
- DeepSeek API для обработки естественного языка
